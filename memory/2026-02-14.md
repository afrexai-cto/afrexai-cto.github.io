# 2026-02-14 ‚Äî Security & 1Password Setup

## 1Password CLI Integration
- Kalin wants all secrets managed via 1Password CLI (`op`) ‚Äî no more plaintext vault files
- Built full security setup:
  - `docs/security/VAULT-GUIDE.md` ‚Äî complete guide
  - `agents/bookkeeper/op.env` ‚Äî Stripe refs for Ledger
  - `agents/outbound-sales/op.env` ‚Äî Gmail refs for Hunter
  - Ledger CONFIG.md updated to use `op run` instead of `source`
  - TOOLS.md updated with 1Password rules
- **Blocker:** `brew install --cask 1password-cli` needs Kalin to run `sudo chown -R openclaw /usr/local/Cellar /usr/local/var/homebrew/locks` first (permission issue)
- Pattern: Kalin stores creds in 1Password vault "AfrexAI", tells me the item name, I use `op://AfrexAI/<Item>/<field>` ‚Äî never read raw values
- Old vault files at `/Users/openclaw/.openclaw/vault/` need migrating to 1Password then deleting
- Stripe live keys (pk + sk) currently in `/Users/openclaw/.openclaw/vault/stripe-afrexai.env` ‚Äî needs migration

## Stripe Keys
- Kalin confirmed Stripe keys are in vault env file
- Wired into Ledger's config (now pointing to op.env references)
- Keys are LIVE (not test) ‚Äî `[REDACTED]...` and `[REDACTED]...`

## 1Password Migration Complete (~02:08 GMT)
- All credentials migrated from old encrypted vault to 1Password AfrexAI vault
- Items: GitHub, Twitter, Slack, Telegram, Brave Search, Notion, QuickBooks, Stripe API, Gmail
- Old vault files deleted (secrets.enc + .vault-key)
- Service account (Kael) has read-only access ‚Äî works for all agent operations
- GitHub token verified working via `op read`
- Gmail app password verified ‚Äî Oracle sent first email to Brent Brodeski @ Savant Wealth

## First Agent Email Sent (~01:11 GMT)
- Oracle (Zara Osei, zosei@afrexai.com) ‚Üí Brent Brodeski, CEO @ Savant Wealth Management
- CC: Kalin + Christina
- Gmail Send As aliases confirmed working for all 9 agents
- DKIM still missing ‚Äî emails landing in spam. Instructions sent to Christina in #ceo-dashboard
- SPF ‚úÖ DMARC ‚úÖ DKIM ‚ùå (Squarespace DNS, need to add google._domainkey TXT record)

## LinkedIn API Setup (~02:35 GMT)
- LinkedIn app: "AfrexAI Agent", client_id: 78xxewc0pmhw7f
- OAuth token obtained, stored in 1Password (item: LinkedIn, ID: wdiu6eso2vrimtdtlgmoa56nte)
- Token expires in ~60 days (5183999 seconds)
- Scope: `w_member_social` only ‚Äî can post as PERSON, NOT as company page
- Company page ID: 105802297 (https://www.linkedin.com/company/105802297/)
- **CANNOT post to company page YET** ‚Äî needs `w_organization_social` scope
- Marketing APIs (Advertising API) **APPROVED** ‚Äî got all 3 scopes: w_member_social, w_organization_social, r_organization_social
- App verified with AfrexAI LinkedIn page ‚úÖ
- **First company page post live:** urn:li:share:7428273505353412608
- Token updated in 1Password with org scopes, expires ~60 days
- Company page ID: 105802297, author URN: urn:li:organization:105802297
- **DO NOT post from Kalin's personal LinkedIn** ‚Äî Matillion privacy rule
- Redirect URI: https://localhost:8080/callback

## Email Templates Humanized (~03:14 GMT)
- 30+ files rewritten across entire codebase: no emojis, no dashes, no bold/italic, human tone
- 6 cold email sequences (financial services, legal, healthcare, real estate, construction, recruitment)
- 3 nurture sequences, all 9 agent prompts, partner program docs, sales one-pagers, referral templates

## Agent Emails Tested (~03:05 GMT)
- 3 emails sent to kimebag@gmail.com from Dana Kessler, Zara Osei, Sofia Reyes ‚Äî testing DKIM deliverability
- 3 emails sent to cbeckford@afrexai.com from Nia Okafor, James Adeyemi, Priya Nair
- All human tone, no formatting
- NEED TO CONFIRM: did emails land in inbox or spam at kimebag@gmail.com?

## DKIM Status
- DNS record live and propagated: google._domainkey.afrexai.com ‚úÖ
- Christina added it via Squarespace DNS
- SPF ‚úÖ DMARC ‚úÖ DKIM ‚úÖ (all 3 now set)
- Google Admin "Start authentication" ‚Äî unclear if clicked yet

## Key Credentials in 1Password (vault: AfrexAI, ID: vvdjufr2us323mgzfm6gex3sly)
- Gmail: ID esnbvzyp4ztyq5imsm34j26osa (ksmolichki@afrexai.com app password)
- LinkedIn: ID wdiu6eso2vrimtdtlgmoa56nte (client_id, client_secret, access_token with org scopes)
- Stripe API: ID cfpvk6eywbaoopfd5gqnbaglgu
- GitHub, Twitter, Slack, Telegram, Brave Search, Notion, QuickBooks ‚Äî all migrated
- Service account token: /Users/openclaw/.openclaw/vault/op-service-account.env
- Service account has READ-ONLY access (cannot create/edit items)
- Old vault files (secrets.enc, .vault-key) DELETED

## Local CRM Built (~04:00 GMT)
- PostgreSQL 17 installed via brew, database: `afrexai_crm`, user: `openclaw` (superuser, local trust)
- PATH: `/usr/local/opt/postgresql@17/bin`
- brew permissions: owned by `kalinsmolichki` not `openclaw`
- Tables: companies, contacts, deals, activities, linkedin_posts, tags, company_tags, email_threads, timeline_events
- Schema upgraded with: role_tier, enrichment_status, last_contacted, domain, last_activity, deal_count, source columns
- Auto-triggers: activities insert ‚Üí updates companies.last_activity + contacts.last_contacted
- Imported: 267 companies (after dedup), 200 contacts, 98 activities
- 101 duplicate companies merged by domain
- Domains populated from websites + contact emails
- psycopg2-binary installed for Python

## CRM Scripts (`crm/scripts/`)
- db.py ‚Äî shared connection helper
- deduplicate.py ‚Äî merge dupes by name/domain/email
- enrich_contacts.py ‚Äî generates search URLs for missing data
- activity_logger.py ‚Äî importable: log_email(), log_call(), log_meeting(), log_note()
- timeline.py ‚Äî CLI chronological touchpoint view
- daily_report.py ‚Äî Slack-formatted daily report
- classify_contacts.py ‚Äî role_tier classification (C-Suite/VP/Director/Manager/Other)
- nlq.py ‚Äî natural language query engine, 18 regex patterns
- populate_domains.py ‚Äî domain extraction + dedup

## CRM Dashboard (`crm/`)
- server.js ‚Äî Express API on port 3456, 10 endpoints
- dashboard.html ‚Äî SPA, dark theme #0a0a0a + gold #FFD700
- Sections: Overview, Companies, Contacts, Pipeline (kanban), Activity Feed, Untouched, Quick Actions
- package.json with express + pg deps
- **Running at http://localhost:3456**

## 3 Agent Emails to Christina (~03:05 GMT)
- Nia Okafor (EA) ‚Äî "Quick sync on this week's priorities"
- James Adeyemi (COO) ‚Äî "Ops update and next steps"
- Priya Nair (Senior Accountant) ‚Äî "Financial snapshot and Stripe status"

## 3 Test Emails to kimebag@gmail.com (~03:04 GMT)
- Dana Kessler, Zara Osei, Sofia Reyes ‚Äî DKIM deliverability test
- RESULT: unknown yet, need Kalin to confirm inbox vs spam

## Strategic Insight (12:49 GMT)
- Kalin confirmed market signal: **customers want AfrexAI to maintain THEIR AI agents and integrate them into THEIR systems/platforms**
- Product = managed AI agent services ‚Äî deploy, integrate, maintain, bill monthly
- Need meta-agents (agents that manage client agents) and integration workflows
- AfrexAI's 9-agent swarm is the prototype for what gets sold
- Key workflows needed: agent health monitoring, integration connectors, update pipelines, performance reporting, escalation routing

## Infrastructure Sprint (11:46 GMT) ‚Äî reported to CEO dashboard
- 16+ workflows built in single session (RAG, Email‚ÜíCRM, Content Pipeline, Twitter Research 3-tier, YouTube Analytics, Council of Experts, Humanizer, NL CRM, Task Manager, Usage/Cost Tracker, Backup System)
- 7 reference docs created in `reference/`
- Keys still needed: OpenAI API, YouTube Data API, TwitterAPI.io, Google Calendar API, Google Drive API, image gen API
- Memory persistence issue flagged ‚Äî some agents losing memory between days, may need to remove `/new` from cron jobs

## CRM Status (14:12 GMT)
- PostgreSQL 17 running, `afrexai_crm` database with 368 companies, 200 contacts, 98 activities
- CRM dashboard server at `crm/server.js` ‚Äî runs on port 3456
- Was down, restarted with `cd crm && node server.js &`
- 270 companies untouched (73.4% of database)
- Top untouched: Armanino, AssuredPartners, Marcum, Addepar, Plaid, Moss Adams, Q2 Holdings (all 400-500 employees)

## Revenue Streams Defined
- **AaaS** (Agents-as-a-Service): PIA Discovery + Build + Fractional Team ($15K-$120K+) ‚Äî Christina closes
- **LaaS** (Leads-as-a-Service): monthly lead delivery ($497-$2,497/mo recurring) ‚Äî agents deliver automatically
- **Context Packs**: self-serve digital ($47-$247 on Stripe)
- **ClawHub Skills**: free funnel ‚Üí paid packs
- LaaS sits NEXT TO AaaS, not on top ‚Äî two parallel revenue streams

## 3 North Stars (defined ~03:00 GMT)
1. üîã Sustainable Energy ‚Äî rest is fuel, burnout kills companies
2. üö¢ Ship What's Built ‚Äî money is in finishing, not starting
3. ü§ù Founder Alignment ‚Äî Kalin + Christina rowing together = force multiplier

## Pages Built Overnight
- 4 vertical landing pages: ai-for-law-firms, ai-for-construction, ai-for-agencies, ai-for-saas
- 3 core product pages: leads.html, ai-audit.html, services.html
- Agent setup pricing updated to 3x ($297/$1,500/$4,500/mo), all CTAs ‚Üí Christina's Calendly

## Real Estate Revenue Engine (14:54 GMT)
- Kalin dropped full execution plan: **Revenue Share AI Operating System for US real estate brokerages (5-50 agents)**
- Model: 15-20% of incremental commission above documented baseline. No uplift = no payout.
- Target: Texas + Florida (high transaction velocity)
- Goal: Sign 2 pilot brokerages within 30 days
- Positioning: "Revenue Acceleration Partner" not automation agency
- **3 sub-agents completed all deliverables in ~5 min:**
  - 100 brokerages researched (50 TX, 50 FL) ‚Üí `prospects/real-estate-brokerages-100.csv` + `prospects/real-estate-research-notes.md`
  - ROI calculator (interactive HTML) ‚Üí `real-estate-engine/roi-calculator.html`
  - Attribution model ‚Üí `real-estate-engine/attribution-model.md`
  - Revenue share agreement ‚Üí `real-estate-engine/revenue-share-agreement.md`
  - 10 outreach emails (5 initial + 5 follow-up) ‚Üí `real-estate-engine/outreach-emails.md`
  - Funnel audit framework ‚Üí `real-estate-engine/funnel-audit-framework.md`
  - Objection handlers ‚Üí `real-estate-engine/objection-handlers.md`
  - Index page ‚Üí `real-estate-engine/index.html`
- KEY FINDING: 95% of brokerages have NO AI chat, 0% have AI lead qualification ‚Äî wide open market
- Data caveats: most emails are info@ (need LinkedIn validation), agent counts ¬±30%
- Kalin asked: should these be stored in CRM? Are these for LaaS vertical? Do we integrate agentic workflows into their lead automations? ‚Äî NEEDS ANSWER

## Security Swarm Deployed (15:03 GMT) ‚Äî SENTINEL system
- Bootstrapped `security/` directory with watchdog, auditor, ghost sub-dirs
- 3 sub-agents ran cycle-0 baseline audits simultaneously
- **WATCHDOG (RED):** Gateway bound to `*:18789` (all interfaces) ‚Äî should be loopback only. Everything else clean (FDs 42/1M, user isolation 700, no token leaks)
- **AUDITOR (YELLOW):** 52 skills hashed, 223 deps with 0 vulns. CRITICAL: GitHub PAT `ghp_KWPm...1VAM` exposed in git remote URL
- **GHOST (YELLOW):** .gitignore only had `node_modules/`. Partial Stripe key prefixes in memory file. Two op.env files had 644 permissions. Legacy vault files still in /vault/
- **4 fixes applied immediately:**
  1. .gitignore updated (covers .env, *.key, vault/, secrets, credentials)
  2. Stripe key prefixes redacted from memory/2026-02-14.md
  3. op.env files chmod 600
  4. Git remote stripped of PAT ‚Äî switched to clean HTTPS URL
- **Still needed:** Kalin must rotate the exposed GitHub PAT in GitHub settings. Gateway binding to 127.0.0.1 needs his OK (may break LAN webchat access).
- Reports saved in `security/{watchdog,auditor,ghost}/REPORTS/cycle-0.md`
- Hash registry baseline at `security/auditor/HASH-REGISTRY.json`

## USER.md Updated (15:09 GMT)
- Added full Identity & Operating Philosophy section per Kalin's request
- Covers: architecture philosophy, PIV/ACE frameworks, Matillion context, AfrexAI math, Shadow Mirror, Identity Firmware, quantum question
- Key phrase: "DEUS EX MACHINA of his own architecture"

## DEAL CLOSING OVERRIDE MODE (15:12 GMT)
- Kalin shifted from research to REVENUE ACTIVATION MODE
- CRM shows 367 companies, 200 contacts, 0 deals ‚Äî all energy was in research, none in closing
- New mandate: close 2 pilot brokerages within 30 days
- Closing squad sub-agent deployed targeting top 5 brokerages:
  1. Teifke Real Estate (Austin TX, 30 agents, Chris Teifke)
  2. Mihara & Associates (Tampa FL, 45 agents)
  3. Monument Realty (Dallas TX, 25 agents, Tiffany & Eddie Burns)
  4. Spyglass Realty (Austin TX, 15 agents, Ryan Rodenbeck)
  5. Mainframe Real Estate (Orlando FL, tech-forward)
- Each email: website audit ‚Üí specific revenue leak ‚Üí concrete dollar math ‚Üí one CTA
- Output: `real-estate-engine/closing-emails-batch1.md` + `real-estate-engine/daily-scoreboard.md`
- Daily scoreboard tracking: emails sent, replies, calls booked, revenue potential
- Rule: if 0 replies after 10 emails ‚Üí rewrite messaging. If 0 calls after 20 ‚Üí refine ICP.

## Email Stress Testing Protocol (15:14 GMT)
- Kalin gave detailed email quality checklist before sending:
  1. Revenue math must be CONCRETE (specific deals/month, commission per deal, not vague "2 more deals")
  2. The "leak" must be OBSERVABLE ("I submitted a test inquiry and..." not "you could improve")
  3. CTA must be low friction ("Open to a 15-min call?" not "let's explore a partnership")
  4. Remove ALL AI language ‚Äî speak in listings, conversion, commission, pipeline
  5. Sequence plan: send 2, wait 45-60 min, send 2, wait, send 1 (domain warming + pacing)
- Psychological reframe: "You are not pitching. You are diagnosing revenue leakage."
- Spyglass Realty email v2 drafted with observable proof ("I submitted a test inquiry through spyglassrealty.com, clicked the talk to expert button, it routes to manual process")
- Confirmed on spyglassrealty.com: "Click this button to talk to a real estate expert" CTA exists, routes manually
- Awaiting Kalin's approval before first send
- **Teifke correction:** Led by Matthew Teifke and Alex Coffman, not Chris

## Closing Emails ‚Äî Send Results (15:17‚Äì16:05 GMT)
- **Teifke Real Estate:** BOUNCED ‚ùå ‚Äî both info@ and matthew@teifkerealestate.com rejected with "550 SMTP Authentication" error. Their entire mail server is misconfigured. Need LinkedIn DM to Matthew Teifke (linkedin.com/in/matthew-teifke-90672438/)
- **Spyglass Realty:** DELIVERED ‚úÖ ‚Äî sent to ryan@spyglassrealty.com (info@ didn't exist, found ryan@ via Salesgear/Saleshandy). SMTP 250 OK.
- **Key lesson:** info@ addresses unreliable for brokerages. Always find owner's direct email first.
- Owner lookup completed: Ray Mihara (Mihara, Tampa), Sean Frank (Mainframe, Orlando), Eddie Burns (Monument ‚Äî but dropped, 800+ agents too big)
- Monument Realty DROPPED from list ‚Äî actually 800+ agents, not 25. Too big for 5-50 target.

## Staggered Send Schedule
- Mihara ‚Üí ray@miharaandassociates.com at 16:30 GMT (cron job a54ef348)
- Mainframe ‚Üí sean@mainframere.com at 17:15 GMT (cron job 61e184e8)
- Need 5th replacement brokerage target

## Austin Median Home Price Verified
- Zillow current: $513K average Austin home value
- 3% commission = $15,400/deal
- +2 deals/month = $370K/year uplift (used in all Austin emails)
- Tampa median: $400-450K range

## Kalin's Delegation Preference (15:10 GMT)
- Told me "delegate dont run them yourself" ‚Äî he wants sub-agents for everything, not me doing fixes inline
- Remember this going forward

## LinkedIn API Capabilities (17:24 GMT)
- Token scopes: `r_organization_social, w_member_social, w_organization_social`
- CAN: post to company page, post as Kalin's profile
- CANNOT: send DMs, connection requests, InMail ‚Äî LinkedIn restricts messaging API to Sales Navigator/Recruiter partners only
- Token appears to have expired or have permission issues ‚Äî /v2/me returns 403 ACCESS_DENIED
- **May need token refresh** ‚Äî original token from 2026-02-14 ~03:00 GMT, expires ~60 days, but /me endpoint failing suggests scope or version issue
- Recommended approach: draft DMs, Kalin sends manually (30 sec each)

## Mihara + Mainframe Delivered (17:18 GMT)
- Both SMTP 250 OK confirmed
- ray@miharaandassociates.com ‚úÖ
- sean@mainframere.com ‚úÖ
- Total delivered: 3 (Spyglass, Mihara, Mainframe)
- Total bounced: 1 (Teifke ‚Äî their mail server broken)
- Cron jobs for staggered sends worked but systemEvent reminders fired while session was inactive ‚Äî need to use isolated agentTurn for time-critical sends instead of systemEvent

## Mission Audit Results (17:15 GMT)
- Momentum score: 3/10
- Primary constraint: email deliverability (bad addresses)
- Probability of 1 pilot in 14 days: 20%
- Need 40-60 delivered emails for 2-3 replies at 3-5% reply rate
- Kill list: security follow-ups, CRM restarts, new pages, research, infra upgrades ‚Äî all non-revenue
- Immediate need: verify 10 more email addresses, send 5 more tonight

## CRM Stability Issue
- CRM server (`crm/server.js` on port 3456) keeps dying ‚Äî runs as foreground process, no persistence
- Needs proper daemonization (PM2 or launchd plist) to stay up
- PostgreSQL itself is stable (brew service), just the Node.js frontend dies

## Key Rotation (22:40 GMT)
- Kalin rotated keys and asked for full audit across all sub-agents
- Audit result: ALL CLEAN ‚Äî git remote no PAT, osxkeychain set, all 9 agent dirs zero hardcoded secrets, op.env files op:// only, 1Password connected
- 3 minor partial token refs in historical audit reports (memory file, security reports) ‚Äî optional cleanup
- Report at `security/sentinel/REPORTS/key-rotation-audit.md`
- Note: Kalin typed "Kyle" ‚Äî it's KAEL. Don't repeat the mistake.

## Evening Session (22:23-22:42 GMT)
- Kalin came back online after ~5 hour gap
- No replies yet on 3 delivered emails (normal ‚Äî Saturday evening)
- Posted status update to #ceo-dashboard Slack channel
- Christina DM drafts still pending ‚Äî Kalin didn't give go-ahead yet

## Static CRM Dashboard on GitHub Pages (23:19 GMT)
- Built password-protected static CRM dashboard at https://afrexai-cto.github.io/crm-dashboard.html
- Password: `afrexai-crm-dashboard@@1` (SHA-256 hashed, client-side check, sessionStorage persistence)
- Dark theme #0a0a0a, gold #FFD700, mobile responsive
- No links to/from main site ‚Äî hidden standalone page
- Data: 367 companies, 200 contacts, 98 activities, 0 deals (embedded as inline JSON)
- Git push method: use `afrexai_token` from 1Password (NOT `token` ‚Äî that's for 1kalin account which lacks repo access)
  - `op read "op://AfrexAI/GitHub/afrexai_token"` ‚Äî this is the one with push access to afrexai-cto org
  - Temporarily set remote URL with token, push, then reset to clean URL
- Auto-refresh crons:
  - Morning 9am GMT: CRM Dashboard Refresh (job 9afe4931)
  - Evening 9pm GMT: CRM Dashboard Refresh (job f1b69a4d)
  - Both query PostgreSQL, update embedded JSON, commit + push

## GitHub Push Notes
- `1kalin` token (field: `token`) = NO push access to afrexai-cto repos (403 denied)
- `afrexai_token` field = HAS push access to afrexai-cto repos ‚úÖ
- osxkeychain has no stored GitHub creds ‚Äî always use 1Password token
- Git committer shows as "OpenClaw Agent <openclaw@192.168.1.200>" ‚Äî should set proper name/email

## CEO Dashboard Agent Fix (22:50-23:06 GMT)
- #ceo-dashboard has a SEPARATE "ceo" agent bound to it (agentId: "ceo", workspace: /Users/openclaw/.openclaw/workspace/agents/ceo/)
- Both Kael (main) and CEO agent can post there ‚Äî Kalin wants both
- CEO agent SOUL.md and CONTEXT.md updated with correct data paths (was pointing to old /workspace/projects/afrexai-swarm/)
- 1Password refs fixed (was "OpenClaw" vault, now "AfrexAI")
- Daily cron jobs set up:
  - Morning 9am GMT: CEO Dashboard Morning Report (job f4e68362)
  - Evening 9pm GMT: CEO Dashboard Evening Report (job c2303448)
  - Both deliver to Slack C0AF3MKPYG1 via isolated agentTurn
- CEO agent hitting **Anthropic 429 rate limit** ‚Äî NOT Slack issue. Too many sub-agents ran today.
- Agent-to-agent messaging is DISABLED (tools.agentToAgent.enabled=true needed)
- Gateway restart needed to clear rate limit + reload rotated keys ‚Äî can't restart from agent, Kalin needs to run `openclaw gateway restart`
- Gateway config: bind="lan" (confirms WATCHDOG finding), port 18789

## Gateway Config Notes
- 3 additional agents configured: trader (Telegram), ceo (Slack), fitness (Telegram)
- Each has own Telegram bot token
- Slack: socket mode, botToken + appToken, channels C0AEF3QQDSA + C0AF3MKPYG1 allowlisted
- Gateway auth: token mode
- Max concurrent: 4 agents, 8 subagents

## Still Blocked (carried from 2026-02-13)
- DNS (SPF/DKIM/DMARC) ‚Äî still no registrar access, email cron still paused
- Google Workspace admin ‚Äî Christina was supposed to grant after 6pm EST on 2/13
- LinkedIn Company Page admin ‚Äî still with Christina
- Gmail IMAP for Aria/Hunter ‚Äî not configured
- QBO credentials for Ledger ‚Äî not yet set up
